# 就活スケジュール管理アプリ - プロジェクト概要

## 🎯 プロジェクトの目的

**就活生向けの包括的な日程管理アプリケーション**を開発し、複数企業への応募における面接・説明会の日程調整を効率化することを目指しています。候補日管理から確定後のカレンダー連携まで、就活における時間管理を一元化します。

### 解決したい課題
- **日程管理の複雑化**: 企業数が増えると面接候補日が重なり、管理が困難になる
- **カレンダーの煩雑化**: 候補日を既存カレンダーに直接入れると見にくくなる
- **候補日の整理**: メールで候補日を送る際に、まとめて分かりやすく出力したい
- **ダブルブッキング**: 面接日程の重複を防ぎたい
- **企業管理の分散**: 選考状況とスケジュールが別々に管理されてしまう

## 🚀 実装済み機能

### 1. 企業管理
- ✅ 企業の追加・編集・削除
- ✅ 業界、応募職種、選考ステージの管理
- ✅ 選考ステージ：書類選考 → 一次面接 → 二次面接 → 最終面接 → 内定/不合格
- ✅ **企業詳細モーダル**: 選考ステージ変更、メモ編集、関連予定表示
- ✅ **企業カードUI**: ドロップダウンメニューで直接ステージ変更・削除

### 2. 予定管理
- ✅ 面接、説明会、グループディスカッション等の予定追加・編集・削除
- ✅ **候補日程の複数設定**（5分刻みの時間選択：開始時間〜終了時間）
- ✅ **個別候補日の編集・削除機能**
- ✅ **確定日程の管理**（候補日からの詳細時間選択）
- ✅ オンライン/オフライン開催の区別
- ✅ メモ・注意事項の記録

### 3. 高度なスケジュール管理
- ✅ **多層競合検出システム**：
  - 確定済みイベントとの重複チェック（前後30分バッファ）
  - 他企業の候補日との重複チェック（前後30分バッファ）
  - 同一イベント内の候補日重複チェック
- ✅ **リアルタイム競合表示**：競合する企業・イベント名を詳細表示
- ✅ **状態別管理**：候補日・確定・キャンセルの完全な状態管理

### 4. 直感的カレンダー機能
- ✅ **月表示カレンダー**：候補日・確定日の視覚的表示
- ✅ **イベント詳細表示**：カレンダー上に企業名・時間・タイプを表示
- ✅ **日付選択詳細**：特定日付の全イベント詳細表示
- ✅ **今後の予定概要**：次の5件の確定予定を時系列表示

### 5. Googleカレンダー連携
- ✅ **個別イベント登録**：確定済み予定の1クリック登録
- ✅ **一括イベント登録**：全確定予定の一括Googleカレンダー登録
- ✅ **詳細情報付与**：企業情報、イベント詳細、備考の自動挿入
- ✅ **日本時間対応**：タイムゾーン考慮した正確な時刻登録

### 6. 統計ダッシュボード
- ✅ 総企業数、確定予定数、候補日数の統計表示
- ✅ タブ形式での企業一覧、予定一覧、カレンダー表示
- ✅ **レスポンシブ統計カード**：視覚的な進捗把握

### 7. 候補日確定機能
- ✅ **段階的確定プロセス**：候補日選択 → 詳細時間選択 → 確定
- ✅ **5分刻み時間選択**：候補日内での詳細時間調整
- ✅ **競合チェック付き確定**：確定時の最終競合確認

## 🎨 UI/UX の特徴

- **レスポンシブデザイン**: スマホ中心、PCでも使いやすい
- **モダンなデザイン**: 学生向け（シンプル・フラット・優しい色合い）
- **ステータス色分け**: 候補日=青、確定=緑、キャンセル=赤（ホバー効果付き）
- **直感的な操作**: ワンクリック確定、ドロップダウンメニュー、モーダル操作
- **視覚的フィードバック**: 競合エラー表示、成功アニメーション、状態バッジ
- **アクセシビリティ**: キーボード操作対応、明確な視覚的階層

## 🏗️ 技術アーキテクチャ

### フロントエンド
- **React 18** + **TypeScript**: コンポーネントベースアーキテクチャ
- **shadcn/ui** + **Radix UI**: アクセシブルなUIコンポーネント
- **Tailwind CSS**: ユーティリティファーストCSS
- **Vite**: 高速開発サーバー・ビルドツール
- **date-fns**: 日時操作・フォーマット（日本語対応）

### 状態管理・データフロー
- **React Hooks**: useState, useCallback, useEffect
- **カスタムフック**: useJobHuntingData（中央集権的データ管理）
- **React Hook Form** + **Zod**: 型安全なフォーム管理・バリデーション
- **React Router DOM**: SPA ルーティング

### 外部連携
- **Google Calendar API**: 確定予定の外部カレンダー登録
- **Browser API**: localStorage（将来的なデータ永続化）

### 主要な型定義
```typescript
interface Company {
  id: string;
  name: string;
  industry: string;
  position: string;
  currentStage: SelectionStage;
  notes?: string;              // 企業に関するメモ
  createdAt: Date;
  updatedAt: Date;
}

interface Event {
  id: string;
  companyId: string;
  companyName: string;
  title: string;
  type: EventType;             // 'interview' | 'info_session' | 'group_discussion' | 'final_interview'
  status: EventStatus;         // 'candidate' | 'confirmed' | 'rejected'
  candidateSlots: TimeSlot[];  // 複数の候補日程
  confirmedSlot?: TimeSlot;    // 確定した日程
  location?: string;
  isOnline: boolean;
  notes?: string;
  createdAt: Date;
  updatedAt: Date;
}

interface TimeSlot {
  startTime: Date;             // 5分刻みで管理
  endTime: Date;
}

type SelectionStage = 'document_review' | 'first_interview' | 'second_interview' | 'final_interview' | 'offer' | 'rejected';
```

## 🔧 高度な競合検出システム

### 多層競合チェック
1. **確定済みイベントとの競合**: 他社・自社の確定済み予定との重複を防ぐ
2. **候補日イベントとの競合**: 他社の候補日との重複を防ぐ  
3. **同一イベント内競合**: 同じイベント内での候補日重複を防ぐ

### バッファ時間システム
- **30分のバッファ**: 移動時間や面接前後の準備時間を考慮
- **全方向適用**: 開始時間の30分前〜終了時間の30分後まで予約不可
- **リアルタイム表示**: 競合する企業名・イベント名を具体的に表示

### 競合判定例
```
既存予定: A社 10/1 11:00〜13:00（確定）
競合範囲: 10/1 10:30〜13:30（前後30分を含む）

新規登録:
❌ B社 10/1 10:45〜12:00 → A社と競合
❌ B社 10/1 12:30〜14:00 → A社と競合  
✅ B社 10/1 13:30〜15:00 → 競合なし

エラー表示: "この時間は以下の予定と重複しています（前後30分を含む）: A社 - 一次面接"
```

### 確定プロセスでの競合管理
```typescript
// 候補日追加時：確定済み + 他社候補日をチェック
checkConfirmedEventConflict(newSlot, allEvents)
getAllExistingCandidateSlots() // 他社の候補日

// 確定時：確定済みイベントのみをチェック  
checkConfirmedEventConflict(selectedSlot, allEvents)
```

## 📱 画面構成・コンポーネント設計

### メイン画面（Index.tsx）
1. **ヘッダー**: アプリタイトル + 企業追加ボタン
2. **統計ダッシュボード**: 企業数、確定予定数、候補日数（レスポンシブカード）
3. **3タブ構成**:
   - **企業一覧**: 応募企業の管理・詳細表示
   - **予定一覧**: 面接・説明会の日程管理・編集
   - **カレンダー**: 月表示カレンダー・Googleカレンダー連携

### 主要コンポーネント詳細

#### 企業管理系
- `AddCompanyForm`: 企業追加フォーム（業界・職種・ステージ）
- `CompanyCard`: 企業カード表示（ドロップダウンメニュー付き）
- `CompanyDetailModal`: 企業詳細モーダル（ステージ変更・メモ・関連予定表示）

#### 予定管理系  
- `AddEventForm`: 予定追加・編集フォーム
  - 候補日程複数設定（5分刻み）
  - 個別候補日編集・削除
  - リアルタイム競合チェック
- `EventCard`: 予定カード表示（編集・削除・確定・Googleカレンダー連携）
- `EventConfirmationModal`: 確定処理モーダル（詳細時間選択）

#### カレンダー系
- `JobCalendar`: 月表示カレンダー
  - 候補日・確定日の視覚的表示
  - 企業名・時間・タイプ表示
  - 日付選択詳細表示
  - 一括Googleカレンダー登録

#### UI基盤
- `DateTimePicker`: カスタム日時選択（Calendar + Select）
- `shadcn/ui`: 統一されたデザインシステム

## 🚧 今後の開発予定

### 短期目標
- [ ] **メール出力フォーマット**: 候補日をまとめて出力
- [ ] **通知・リマインダー機能**: 面接前日の通知
- [ ] **データ永続化**: localStorage/IndexedDBでのデータ保存

### 中期目標
- [ ] **進捗分析機能**: 選考状況の可視化・統計表示
- [ ] **データエクスポート**: 就活活動の記録保存（CSV/Excel）
- [ ] **企業情報データベース**: 業界・企業情報の自動取得

### 長期目標
- [ ] **チーム機能**: 複数学生での日程調整・情報共有
- [ ] **AI支援**: 日程調整の最適化提案・面接対策アドバイス
- [ ] **モバイルアプリ**: ネイティブアプリ版の開発

## 💡 開発時の注意点

### データの永続化
- 現在はローカルステート（useState）で管理
- 将来的にはローカルストレージやデータベース連携を検討

### パフォーマンス
- 候補日程が多い場合の表示最適化
- 大量の企業・予定データの処理

### ユーザビリティ
- モバイルファーストの操作感
- 直感的な日程選択・確定フロー

## 🔍 トラブルシューティング

### 実装済み機能での問題解決

#### 日時選択・競合検出
1. **候補日が追加できない**
   - 既存予定との30分バッファ競合をチェック
   - 5分刻み以外の時間が設定されていないか確認
   - `checkConfirmedEventConflict`の戻り値を確認

2. **Googleカレンダー登録で時刻がずれる**
   - `generateGoogleCalendarUrl`の日時フォーマット確認
   - タイムゾーン設定（Asia/Tokyo）の適用確認
   - ブラウザのローカル時刻とサーバー時刻の差異確認

3. **企業削除時にイベントが残る**
   - `deleteCompany`関数で関連イベントも削除されるか確認
   - `useJobHuntingData`のデータ整合性確認

### デバッグポイント
- **状態管理**: `useJobHuntingData`フックのデータフロー
- **競合検出**: `conflictDetection.ts`の多層チェックロジック
- **Google Calendar**: `googleCalendar.ts`の時刻変換・URL生成
- **フォーム**: React Hook Form + Zodバリデーション
- **モーダル**: Dialog状態管理とデータ受け渡し

### パフォーマンス最適化
- 大量の候補日がある場合の表示最適化
- カレンダー描画の最適化（仮想化）
- リアルタイム競合チェックの負荷軽減

---

## 📋 最新の機能概要

このドキュメントは2025年8月時点の最新実装を反映しています：

✅ **完全実装済み**: Googleカレンダー連携、月表示カレンダー、企業詳細管理、高度な競合検出
✅ **UI/UX**: 5分刻み時間選択、レスポンシブデザイン、アクセシブルなコンポーネント
✅ **技術基盤**: React 18 + TypeScript + shadcn/ui + Tailwindによるモダンな開発環境

このドキュメントは、プロジェクトの全体像を把握し、新機能の実装や既存機能の修正に取り掛かる際の指針となります。常に最新の状態に更新し、開発チーム全体で共有してください。
